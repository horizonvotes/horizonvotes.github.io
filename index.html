<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Voting Panel</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f2f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .container {
      background-color: white;
      border: 2px solid #d1d5db;
      padding: 30px;
      text-align: center;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      border-radius: 12px;
      position: relative;
    }

    .btn {
      display: block;
      width: 100%;
      margin: 12px auto;
      padding: 12px;
      font-size: 16px;
      font-weight: 500;
      border: 2px solid #2563eb;
      background-color: white;
      color: #2563eb;
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 8px;
    }

    .btn:hover:enabled {
      background-color: #eff6ff;
    }

    .btn:disabled {
      background-color: #f3f4f6;
      border-color: #d1d5db;
      color: #9ca3af;
      cursor: not-allowed;
    }

    .btn-next {
      background-color: #2563eb;
      color: white;
    }

    .btn-next:hover:enabled {
      background-color: #1d4ed8;
    }

    .btn-next:disabled {
      background-color: #93c5fd;
      border-color: #93c5fd;
    }

    #mainMenu .btn:nth-child(2) {
      border-color: #4b5563;
      color: #4b5563;
    }

    #mainMenu .btn:nth-child(2):hover {
      background-color: #f3f4f6;
    }

    #mainMenu .btn:nth-child(3) {
      border-color: #dc2626;
      color: #dc2626;
    }

    #mainMenu .btn:nth-child(3):hover {
      background-color: #fef2f2;
    }

    .hidden {
      display: none;
    }

    .title {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 24px;
      color: #111827;
    }

    .back-arrow {
      position: absolute;
      top: 16px;
      left: 16px;
      font-size: 24px;
      cursor: pointer;
      background: none;
      border: none;
      color: #4b5563;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background-color 0.2s;
    }

    .back-arrow:hover {
      background-color: #f3f4f6;
    }

    .vote-list {
      text-align: left;
      margin-top: 20px;
      width: 100%;
    }

    .vote-section {
      margin-bottom: 16px;
      font-weight: 600;
      font-size: 18px;
      text-align: center;
      background-color: #f3f4f6;
      padding: 10px;
      border-radius: 8px;
      color: #111827;
    }

    .winner {
      border-top: 2px solid #e5e7eb;
      margin-top: 20px;
      padding-top: 20px;
      font-weight: 600;
      color: #059669;
      text-align: center;
    }

    .candidate-row {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #e5e7eb;
      padding: 10px 0;
    }

    .category-btn {
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
      font-weight: 500;
    }

    .category-btn:hover {
      border-color: #2563eb;
      background-color: #eff6ff;
    }

    .scroll-container {
      max-height: 60vh;
      overflow-y: auto;
      margin: 16px 0;
      padding-right: 8px;
    }

    .scroll-container::-webkit-scrollbar {
      width: 6px;
    }

    .scroll-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .scroll-container::-webkit-scrollbar-thumb {
      background: #2563eb;
      border-radius: 10px;
    }

    .selected {
      background-color: #eff6ff;
      border: 3px solid #2563eb;
      box-shadow: 0 0 0 2px #bfdbfe;
    }

    @media (max-width: 480px) {
      .container {
        padding: 24px 20px;
      }
      
      .title {
        font-size: 20px;
        margin-bottom: 20px;
      }
      
      .btn {
        padding: 10px;
        font-size: 15px;
      }
    }
  </style>
</head>
<body>

<div class="container" id="mainMenu">
  <div class="title">Voting Panel</div>
  <button class="btn" onclick="startVoting()">Start voting</button>
  <button class="btn" onclick="askViewVotes()">View total votes</button>
  <button class="btn" onclick="confirmClearVotes()">Delete all votes</button>
</div>

<div class="container hidden" id="voteSummary">
  <button class="back-arrow" onclick="goTo('voteSummary', 'mainMenu')">&larr;</button>
  <div class="title">Vote Summary</div>
  <div class="scroll-container" id="voteButtons"></div>
</div>

<div class="container hidden" id="categoryVotes">
  <button class="back-arrow" onclick="goTo('categoryVotes', 'voteSummary')">&larr;</button>
  <div class="title" id="categoryTitle"></div>
  <div class="scroll-container">
    <div id="voteDisplay" class="vote-list"></div>
  </div>
</div>

<div class="container hidden" id="thankYouMenu">
  <button class="back-arrow" onclick="askBack('thankYouMenu')">&larr;</button>
  <button class="btn" onclick="restartVoting()">Start Voting</button>
</div>

<script>
const positions = [
  "Vice Captain Aravali",
  "Vice Captain Himalaya",
  "Vice Captain Nilgiri",
  "Vice Captain Sayadri",
  "Captain Aravali",
  "Captain Himalaya",
  "Captain Nilgiri",
  "Captain Sayadri",
  "Sports Captain (Boy)",
  "Sports Captain (Girl)",
  "Head Girl",
  "Head Boy"
];

const candidates = {
  "Vice Captain Aravali": ["Rahul Sharma", "Priya Patel", "Amit Singh"],
  "Vice Captain Himalaya": ["Neha Gupta", "Vikram Joshi", "Sanya Malhotra"],
  "Vice Captain Nilgiri": ["Arjun Kapoor", "Meera Nair", "Rohan Desai"],
  "Vice Captain Sayadri": ["Ananya Iyer", "Karan Mehta", "Divya Reddy"],
  "Captain Aravali": ["Aditya Verma", "Shreya Choudhary", "Rajat Khanna"],
  "Captain Himalaya": ["Tanvi Shah", "Rohit Srinivasan", "Pooja Agarwal"],
  "Captain Nilgiri": ["Varun Bhatia", "Ishita Kapoor", "Siddharth Malhotra"],
  "Captain Sayadri": ["Nisha Rao", "Aryan Chawla", "Kavya Menon"],
  "Sports Captain (Boy)": ["Ravi Kumar", "Harsh Pandey", "Yash Oberoi"],
  "Sports Captain (Girl)": ["Diya Singh", "Anjali Mishra", "Tanya Chopra"],
  "Head Girl": ["Sanjana Mehta", "Aishwarya Nair", "Ira Joshi"],
  "Head Boy": ["Kunal Saxena", "Dhruv Malhotra", "Vedant Sharma"]
};

let current = 0;
let selectedCandidate = null;

function startVoting() {
  document.getElementById("mainMenu").classList.add("hidden");
  selectedCandidate = null;
  showFrame(positions[current]);
}

function restartVoting() {
  current = 0;
  selectedCandidate = null;
  showFrame(positions[current]);
}

function showFrame(title) {
  // Hide all containers
  document.querySelectorAll('.container').forEach(container => {
    container.classList.add("hidden");
  });

  let id = title.replace(/[^a-zA-Z]/g, "");
  let div = document.getElementById(id);

  if (!div) {
    div = document.createElement("div");
    div.className = "container";
    div.id = id;
    div.innerHTML = `
      <button class="back-arrow" onclick="askBack('${id}')">&larr;</button>
      <div class="title">${title}</div>
      <button class="btn candidate-btn" onclick="selectCandidate('${title}', 0, this)">${candidates[title][0]}</button>
      <button class="btn candidate-btn" onclick="selectCandidate('${title}', 1, this)">${candidates[title][1]}</button>
      <button class="btn candidate-btn" onclick="selectCandidate('${title}', 2, this)">${candidates[title][2]}</button>
      <button class="btn btn-next" onclick="proceedToNext('${title}')" disabled>Next</button>
    `;
    document.body.appendChild(div);
  } else {
    // Reset selection when showing frame
    div.querySelectorAll('.candidate-btn').forEach(btn => {
      btn.classList.remove("selected");
    });
    div.querySelector('.btn-next').disabled = true;
  }
  div.classList.remove("hidden");
}

function selectCandidate(title, candidateIndex, buttonElement) {
  const buttons = document.querySelectorAll(`#${title.replace(/[^a-zA-Z]/g, "")} .candidate-btn`);
  buttons.forEach(btn => {
    btn.classList.remove("selected");
  });
  
  buttonElement.classList.add("selected");
  document.querySelector(`#${title.replace(/[^a-zA-Z]/g, "")} .btn-next`).disabled = false;
  selectedCandidate = { title, candidateIndex };
}

function proceedToNext(title) {
  if (selectedCandidate && selectedCandidate.title === title) {
    // Record the vote before moving to next frame
    vote(title, selectedCandidate.candidateIndex);
    // Clear selection after voting
    selectedCandidate = null;
  }
}

function vote(title, candidateIndex) {
  let key = title;
  let data = JSON.parse(localStorage.getItem(key) || '[0,0,0]');
  data[candidateIndex]++;
  localStorage.setItem(key, JSON.stringify(data));

  current++;
  if (current < positions.length) {
    showFrame(positions[current]);
  } else {
    document.querySelector('.container:not(.hidden)').classList.add('hidden');
    document.getElementById("thankYouMenu").classList.remove("hidden");
  }
}

function askBack(currentId) {
  const pass = prompt("Enter password to return to dashboard:");
  if (pass === "1234") {
    document.getElementById(currentId).classList.add("hidden");
    document.getElementById("mainMenu").classList.remove("hidden");
    current = 0;
    selectedCandidate = null;
  }
}

function askViewVotes() {
  const pass = prompt("Enter password to view total votes:");
  if (pass === "1234") {
    showVotes();
  }
}

function showVotes() {
  const voteButtons = document.getElementById("voteButtons");
  voteButtons.innerHTML = '';
  
  positions.forEach(pos => {
    const btn = document.createElement("button");
    btn.className = "category-btn";
    btn.textContent = pos;
    btn.onclick = () => showCategoryVotes(pos);
    voteButtons.appendChild(btn);
  });

  document.getElementById("mainMenu").classList.add("hidden");
  document.getElementById("voteSummary").classList.remove("hidden");
}

function showCategoryVotes(title) {
  document.getElementById("voteSummary").classList.add("hidden");
  document.getElementById("categoryVotes").classList.remove("hidden");
  
  const display = document.getElementById("voteDisplay");
  const titleElement = document.getElementById("categoryTitle");
  const data = JSON.parse(localStorage.getItem(title) || '[0,0,0]');
  
  titleElement.textContent = title;
  display.innerHTML = '';
  
  let maxVotes = Math.max(...data);
  let winnerIndex = data.indexOf(maxVotes);
  
  data.forEach((votes, index) => {
    const row = document.createElement("div");
    row.className = "candidate-row";
    row.innerHTML = `
      <span>${candidates[title][index]}</span>
      <span>${votes} vote${votes !== 1 ? 's' : ''}</span>
    `;
    display.appendChild(row);
  });
  
  const winnerDiv = document.createElement("div");
  winnerDiv.className = "winner";
  winnerDiv.innerHTML = `
    <div>Winner</div>
    <div style="margin-top: 10px; font-size: 18px;">${candidates[title][winnerIndex]}</div>
    <div>with ${maxVotes} vote${maxVotes !== 1 ? 's' : ''}</div>
  `;
  display.appendChild(winnerDiv);
}

function confirmClearVotes() {
  const pass = prompt("Enter password to delete all votes:");
  if (pass === "1234") {
    localStorage.clear();
    alert("All votes deleted.");
  }
}

function goTo(from, to) {
  document.getElementById(from).classList.add("hidden");
  document.getElementById(to).classList.remove("hidden");
  if (to === 'mainMenu') {
    current = 0;
    selectedCandidate = null;
  }
}
</script>
</body>
</html>
